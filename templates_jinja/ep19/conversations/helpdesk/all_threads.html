{% extends "ep19/conversations/base.html" %}

{% block breadcrumbs %}
{{ super() }}
&raquo; <a href='#'>Helpdesk</a>
&raquo; <a href='#'>All threads</a>
{% endblock %}

{% block conversations_content %}
    <a href="{{ url("staff_helpdesk:inbox") }}">Go to inbox</a>

    {{ typography.heading("All threads", 4, class="mb2") }}

    {# TODO make it into a table in material #}
    <table>
        <tr>
            <th>id</th>
            <th>title</th>
            <th><a href='?{{ ThreadFilters.order_by_status }}'>status</a></th>
            <th><a href='?{{ ThreadFilters.order_by_priority }}'>priority</a></th>
            <th><a href='?{{ ThreadFilters.order_by_last_message }}'>last message</a></th>
            <th>people</th>
        </tr>

        {% for thread in all_threads %}
        <tr>
            <td>{{ thread.id }}</td>
            <td><a href='{{ thread.get_staff_url() }}'>{{ thread.title }}</a></td>
            <td class='status-bg-{{ thread.status }}'>{{ thread.get_status_display() }}</td>
            <td class='priority-bg-{{ thread.priority }}'>{{ thread.get_priority_display() }}</td>
            <td title="{{ thread.last_message_date }}">{{ timesince(thread.last_message_date) }} ago</td>
            <td>
                {% for user in thread.people_involved() %}
                {{ user }},
                {% endfor %}
            </td>
        </tr>
        {% endfor %}{# thread in actionble #}
    </table>

{% endblock conversations_content %}
